<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™ì› ì—…ë¬´ ê´€ë¦¬ ì‹œìŠ¤í…œ - í…ŒìŠ¤íŠ¸ ë²„ì „</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            color: #334155;
            font-size: 14px;
        }
        
        /* ë°˜ì‘í˜• í…ìŠ¤íŠ¸ í¬ê¸° */
        @media (max-width: 1200px) {
            body { font-size: 13px; }
            h1 { font-size: 1.5rem !important; }
            h2 { font-size: 1.25rem !important; }
        }
        @media (max-width: 768px) {
            body { font-size: 12px; }
            h1 { font-size: 1.25rem !important; }
            h2 { font-size: 1.125rem !important; }
        }
        @media (max-width: 480px) {
            body { font-size: 11px; }
            h1 { font-size: 1.125rem !important; }
            h2 { font-size: 1rem !important; }
        }

        /* ê³„ì • ì •ë³´ ìš°ìƒë‹¨ */
        .account-info {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 200;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            font-size: 0.875rem;
        }

        /* íƒ€ì„ë¼ì¸ */
        .timeline {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
            gap: 1px;
            background: #e2e8f0;
            border-radius: 0.5rem;
            overflow: hidden;
            margin-bottom: 1rem;
            min-height: 80px;
        }

        .timeline-day {
            background: white;
            padding: 0.25rem;
            text-align: center;
            font-size: 0.75rem;
            position: relative;
            border-right: 1px solid #e2e8f0;
        }

        .timeline-month {
            background: #f1f5f9;
            font-weight: 600;
            color: #475569;
        }

        .timeline-today {
            background: #dbeafe;
            color: #1e40af;
            font-weight: 600;
        }

        /* ì—…ë¬´ ë³´ë“œ */
        .board-grid {
            display: grid;
            grid-template-columns: 120px repeat(4, minmax(200px, 1fr)) 200px;
            grid-template-rows: auto 1fr 1fr;
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            background: white;
        }

        .grid-cell {
            padding: 1rem;
            border: 1px solid #e2e8f0;
            min-height: 150px;
        }

        .header-cell {
            background-color: #f8fafc;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-bottom: 2px solid #cbd5e1;
        }

        .done-header {
            background-color: #dcfce7;
            color: #166534;
        }

        .row-label {
            background-color: #f8fafc;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            border-right: 2px solid #cbd5e1;
        }

        .task-column {
            background-color: white;
            padding: 0.75rem;
        }

        .row-span-2 {
            grid-row: span 2;
        }

        /* ì—…ë¬´ ì•„ì´í…œ */
        .task-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: grab;
            transition: all 0.2s;
            position: relative;
        }

        .task-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .task-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        /* ëª¨ë‹¬ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 1200px) {
            .board-grid {
                grid-template-columns: 100px repeat(4, minmax(150px, 1fr)) 150px;
            }
            .grid-cell {
                padding: 0.75rem;
                min-height: 120px;
            }
        }

        @media (max-width: 768px) {
            .board-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }
            .grid-cell {
                border: none;
                margin-bottom: 1rem;
                border-radius: 0.5rem;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .row-span-2 {
                grid-row: auto;
            }
        }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-small {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
        }

        /* ì…ë ¥ í•„ë“œ */
        .input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            font-size: 0.875rem;
        }

        .input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }

        /* ì¶•í•˜ ëª¨ë‹¬ */
        .celebration-modal {
            background: linear-gradient(135deg, #8b5cf6, #ec4899);
            color: white;
            text-align: center;
            padding: 2rem;
            border-radius: 1rem;
            animation: bounceIn 0.6s ease-out;
        }

        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }

        /* í…ŒìŠ¤íŠ¸ ë°°ë„ˆ */
        .test-banner {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: white;
            text-align: center;
            padding: 0.5rem;
            font-weight: 600;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 300;
        }
    </style>
</head>
<body class="pt-16">
    <!-- í…ŒìŠ¤íŠ¸ ë°°ë„ˆ -->
    <div class="test-banner">
        ğŸ§ª í…ŒìŠ¤íŠ¸ ë²„ì „ - ë¡œê·¸ì¸ ì—†ì´ ëª¨ë“  ê¸°ëŠ¥ì„ ì²´í—˜í•´ë³´ì„¸ìš”!
    </div>

    <!-- ê³„ì • ì •ë³´ (ìš°ìƒë‹¨) -->
    <div class="account-info">
        <span class="font-semibold">í…ŒìŠ¤íŠ¸ í•™ì›</span>
        <span class="text-sm text-gray-500">í…ŒìŠ¤íŠ¸ ëª¨ë“œ</span>
    </div>

    <!-- ë©”ì¸ í™”ë©´ -->
    <div class="container mx-auto px-4 pt-4">
        <!-- í—¤ë” -->
        <div class="text-center mb-6">
            <h1 class="text-2xl font-bold mb-2">í…ŒìŠ¤íŠ¸ í•™ì› ì—…ë¬´ ê´€ë¦¬ ì‹œìŠ¤í…œ</h1>
            <p id="welcome-message" class="text-gray-600">íš¨ìœ¨ì ì¸ ì—…ë¬´ ê´€ë¦¬ë¡œ ë” ë‚˜ì€ êµìœ¡ì„ ë§Œë“¤ì–´ê°€ì„¸ìš”!</p>
        </div>

        <!-- ì„ ìƒë‹˜ ì„ íƒ -->
        <div class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <div class="flex items-center gap-4 flex-wrap">
                <label class="font-semibold">ì„ ìƒë‹˜ ì„ íƒ:</label>
                <select id="teacher-select" class="input flex-1 max-w-xs">
                    <option value="">ì„ ìƒë‹˜ì„ ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="teacher1">ê¹€ì„ ìƒë‹˜</option>
                    <option value="teacher2">ì´ì„ ìƒë‹˜</option>
                    <option value="teacher3">ë°•ì„ ìƒë‹˜</option>
                </select>
                <button id="add-teacher-btn" class="btn btn-secondary">+ ì„ ìƒë‹˜ ì¶”ê°€</button>
                <button id="delete-teacher-btn" class="btn btn-danger" style="display: none;">ì„ ìƒë‹˜ ì‚­ì œ</button>
            </div>
        </div>

        <!-- ì„ íƒëœ ì„ ìƒë‹˜ ì •ë³´ -->
        <div id="teacher-info" style="display: none;" class="text-center mb-6">
            <h2 id="teacher-title" class="text-xl font-semibold mb-2"></h2>
            <p id="teacher-message" class="text-gray-600"></p>
        </div>

        <!-- íƒ€ì„ë¼ì¸ -->
        <div id="timeline-container" style="display: none;" class="bg-white p-4 rounded-lg shadow-sm mb-6">
            <h3 class="font-semibold mb-3">ì—…ë¬´ íƒ€ì„ë¼ì¸</h3>
            <div id="timeline" class="timeline"></div>
        </div>

        <!-- ì—…ë¬´ ë³´ë“œ -->
        <div id="board-container" style="display: none;" class="mb-6">
            <div class="board-grid">
                <!-- í—¤ë” -->
                <div class="grid-cell header-cell"></div>
                <div class="grid-cell header-cell">Mandatory<br>(í•„ìˆ˜)</div>
                <div class="grid-cell header-cell">Low-hanging Fruit<br>(ì„±ê³¼ ë‚´ê¸° ì‰¬ìš´ ì¼)</div>
                <div class="grid-cell header-cell">Deep-Infra Building<br>(êµ¬ì¡° íš¨ìœ¨í™”)</div>
                <div class="grid-cell header-cell">Innovation<br>(í˜ì‹ )</div>
                <div class="grid-cell header-cell done-header">ì™„ë£Œ (Done)</div>

                <!-- ì§„í–‰ ì¤‘ í–‰ -->
                <div class="grid-cell row-label">Ongoing<br>(ì§„í–‰ì¤‘)</div>
                <div id="mandatory-ongoing" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'mandatory', 'ongoing')"></div>
                <div id="low-hanging-ongoing" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'low-hanging', 'ongoing')"></div>
                <div id="deep-infra-ongoing" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'deep-infra', 'ongoing')"></div>
                <div id="innovation-ongoing" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'innovation', 'ongoing')"></div>
                <div id="done-column" class="task-column grid-cell row-span-2" ondragover="allowDrop(event)" ondrop="drop(event, 'done', null)"></div>

                <!-- ìˆìœ¼ë©´ ì¢‹ì€ ê²ƒ í–‰ -->
                <div class="grid-cell row-label">Nice to have<br>(í•˜ê³  ì‹¶ì€ ê²ƒ)</div>
                <div id="mandatory-nice-to-have" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'mandatory', 'nice-to-have')"></div>
                <div id="low-hanging-nice-to-have" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'low-hanging', 'nice-to-have')"></div>
                <div id="deep-infra-nice-to-have" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'deep-infra', 'nice-to-have')"></div>
                <div id="innovation-nice-to-have" class="task-column grid-cell" ondragover="allowDrop(event)" ondrop="drop(event, 'innovation', 'nice-to-have')"></div>
            </div>
        </div>

        <!-- ì—…ë¬´ ì¶”ê°€ -->
        <div id="add-task-section" style="display: none;" class="bg-white p-4 rounded-lg shadow-sm">
            <h3 class="font-semibold mb-4">ìƒˆë¡œìš´ ì—…ë¬´ ì¶”ê°€</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4">
                <input type="text" id="task-content" class="input" placeholder="ì—…ë¬´ ë‚´ìš©">
                <input type="number" id="estimated-time" class="input" placeholder="ì˜ˆìƒ ì†Œìš”ì‹œê°„ (ì‹œê°„)">
                <input type="date" id="due-date" class="input">
                <select id="task-category" class="input">
                    <option value="mandatory">í•„ìˆ˜</option>
                    <option value="low-hanging">ë¡œìš° í–‰ì‰</option>
                    <option value="deep-infra">ì‹¬ì¸µ ì¸í”„ë¼</option>
                    <option value="innovation">í˜ì‹ </option>
                </select>
                <select id="task-priority" class="input">
                    <option value="ongoing">ì§„í–‰ ì¤‘</option>
                    <option value="nice-to-have">ìˆìœ¼ë©´ ì¢‹ì€ ê²ƒ</option>
                </select>
                <select id="task-type" class="input">
                    <option value="deadline">ë§ˆê°ì¼ ìˆìŒ</option>
                    <option value="daily">ë§¤ì¼ ê¾¸ì¤€íˆ</option>
                </select>
            </div>
            <button id="add-task-btn" class="btn btn-primary">ì—…ë¬´ ì¶”ê°€</button>
        </div>
    </div>

    <!-- ëª¨ë‹¬ë“¤ -->
    
    <!-- ì„ ìƒë‹˜ ì¶”ê°€ ëª¨ë‹¬ -->
    <div id="teacher-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-lg font-semibold mb-4">ìƒˆ ì„ ìƒë‹˜ ì¶”ê°€</h3>
            <input type="text" id="new-teacher-name" class="input mb-4" placeholder="ì„ ìƒë‹˜ ì´ë¦„">
            <div class="flex gap-2 justify-end">
                <button id="cancel-teacher-btn" class="btn btn-secondary">ì·¨ì†Œ</button>
                <button id="save-teacher-btn" class="btn btn-primary">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ì—…ë¬´ ì™„ë£Œ ëª¨ë‹¬ -->
    <div id="completion-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-lg font-semibold mb-4">ì—…ë¬´ ì™„ë£Œ</h3>
            <p class="mb-4">ì‹¤ì œ ì†Œìš”ëœ ì‹œê°„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <input type="number" id="actual-time" class="input mb-4" placeholder="ì‹¤ì œ ì†Œìš”ì‹œê°„ (ì‹œê°„)">
            <div class="flex gap-2 justify-end">
                <button id="cancel-completion-btn" class="btn btn-secondary">ì·¨ì†Œ</button>
                <button id="confirm-completion-btn" class="btn btn-primary">ì™„ë£Œ</button>
            </div>
        </div>
    </div>

    <!-- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
    <div id="delete-modal" class="modal">
        <div class="modal-content">
            <h3 class="text-lg font-semibold mb-4">ì—…ë¬´ ì‚­ì œ</h3>
            <p class="mb-4">ì •ë§ ì´ ì—…ë¬´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
            <div class="flex gap-2 justify-end">
                <button id="cancel-delete-btn" class="btn btn-secondary">ì·¨ì†Œ</button>
                <button id="confirm-delete-btn" class="btn btn-danger">ì‚­ì œ</button>
            </div>
        </div>
    </div>

    <!-- ì¶•í•˜ ëª¨ë‹¬ -->
    <div id="celebration-modal" class="modal">
        <div class="celebration-modal">
            <div id="celebration-message"></div>
        </div>
    </div>

    <script>
        // í…ŒìŠ¤íŠ¸ìš© ë°ì´í„° ì €ì¥ì†Œ
        let testData = {
            teachers: [
                { id: 'teacher1', name: 'ê¹€ì„ ìƒë‹˜' },
                { id: 'teacher2', name: 'ì´ì„ ìƒë‹˜' },
                { id: 'teacher3', name: 'ë°•ì„ ìƒë‹˜' }
            ],
            tasks: []
        };

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
        const savedData = localStorage.getItem('test-academy-data');
        if (savedData) {
            testData = JSON.parse(savedData);
        }

        let currentTeacher = null;
        let taskToDelete = null;
        let taskToComplete = null;

        // DOM ìš”ì†Œë“¤
        const teacherSelect = document.getElementById('teacher-select');
        const addTeacherBtn = document.getElementById('add-teacher-btn');
        const deleteTeacherBtn = document.getElementById('delete-teacher-btn');
        const teacherInfo = document.getElementById('teacher-info');
        const teacherTitle = document.getElementById('teacher-title');
        const teacherMessage = document.getElementById('teacher-message');
        const welcomeMessage = document.getElementById('welcome-message');
        const timelineContainer = document.getElementById('timeline-container');
        const timeline = document.getElementById('timeline');
        const boardContainer = document.getElementById('board-container');
        const addTaskSection = document.getElementById('add-task-section');

        // ëª¨ë‹¬ ìš”ì†Œë“¤
        const teacherModal = document.getElementById('teacher-modal');
        const newTeacherName = document.getElementById('new-teacher-name');
        const saveTeacherBtn = document.getElementById('save-teacher-btn');
        const cancelTeacherBtn = document.getElementById('cancel-teacher-btn');
        
        const completionModal = document.getElementById('completion-modal');
        const actualTimeInput = document.getElementById('actual-time');
        const confirmCompletionBtn = document.getElementById('confirm-completion-btn');
        const cancelCompletionBtn = document.getElementById('cancel-completion-btn');
        
        const deleteModal = document.getElementById('delete-modal');
        const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
        const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
        
        const celebrationModal = document.getElementById('celebration-modal');
        const celebrationMessage = document.getElementById('celebration-message');

        // ì—…ë¬´ ì¶”ê°€ ìš”ì†Œë“¤
        const taskContentInput = document.getElementById('task-content');
        const estimatedTimeInput = document.getElementById('estimated-time');
        const dueDateInput = document.getElementById('due-date');
        const taskCategorySelect = document.getElementById('task-category');
        const taskPrioritySelect = document.getElementById('task-priority');
        const taskTypeSelect = document.getElementById('task-type');
        const addTaskBtn = document.getElementById('add-task-btn');

        // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        teacherSelect.addEventListener('change', selectTeacher);
        addTeacherBtn.addEventListener('click', () => showModal(teacherModal));
        deleteTeacherBtn.addEventListener('click', deleteSelectedTeacher);
        saveTeacherBtn.addEventListener('click', saveNewTeacher);
        cancelTeacherBtn.addEventListener('click', () => hideModal(teacherModal));
        confirmCompletionBtn.addEventListener('click', confirmTaskCompletion);
        cancelCompletionBtn.addEventListener('click', () => hideModal(completionModal));
        confirmDeleteBtn.addEventListener('click', confirmTaskDeletion);
        cancelDeleteBtn.addEventListener('click', () => hideModal(deleteModal));
        addTaskBtn.addEventListener('click', addNewTask);

        // ì´ˆê¸°í™”
        loadTeachers();

        // í•¨ìˆ˜ë“¤
        function saveData() {
            localStorage.setItem('test-academy-data', JSON.stringify(testData));
        }

        function loadTeachers() {
            teacherSelect.innerHTML = '<option value="">ì„ ìƒë‹˜ì„ ì„ íƒí•˜ì„¸ìš”</option>';
            testData.teachers.forEach(teacher => {
                const option = document.createElement('option');
                option.value = teacher.id;
                option.textContent = teacher.name;
                teacherSelect.appendChild(option);
            });
        }

        function selectTeacher() {
            const teacherId = teacherSelect.value;
            if (!teacherId) {
                hideTeacherBoard();
                deleteTeacherBtn.style.display = 'none';
                welcomeMessage.textContent = 'íš¨ìœ¨ì ì¸ ì—…ë¬´ ê´€ë¦¬ë¡œ ë” ë‚˜ì€ êµìœ¡ì„ ë§Œë“¤ì–´ê°€ì„¸ìš”!';
                return;
            }

            const teacher = testData.teachers.find(t => t.id === teacherId);
            if (teacher) {
                currentTeacher = teacher;
                deleteTeacherBtn.style.display = 'inline-block';
                welcomeMessage.textContent = `ì˜¤ëŠ˜ë„ êµìœ¡ ì‹œìŠ¤í…œì˜ ìµœì¢…ì  í•´ë‹µì„ í’€ì–´ê°€ì‹œëŠ” ${teacher.name}! ê°ì‚¬í•©ë‹ˆë‹¤!`;
                showTeacherBoard();
                loadTeacherTasks();
            }
        }

        function showTeacherBoard() {
            teacherInfo.style.display = 'block';
            timelineContainer.style.display = 'block';
            boardContainer.style.display = 'block';
            addTaskSection.style.display = 'block';
            
            teacherTitle.textContent = `${currentTeacher.name} ì—…ë¬´ ê´€ë¦¬ ë³´ë“œ`;
            teacherMessage.textContent = `êµìœ¡ ì‹œìŠ¤í…œì˜ ìµœì¢…ì  í•´ë‹µì„ ì˜¤ëŠ˜ë„ í’€ì–´ê°€ëŠ” ${currentTeacher.name}! ê°ì‚¬í•©ë‹ˆë‹¤!`;
            
            generateTimeline();
        }

        function hideTeacherBoard() {
            teacherInfo.style.display = 'none';
            timelineContainer.style.display = 'none';
            boardContainer.style.display = 'none';
            addTaskSection.style.display = 'none';
        }

        function generateTimeline() {
            const today = new Date();
            const startDate = new Date(today);
            startDate.setDate(startDate.getDate() - 14); // 2ì£¼ ì „
            
            const endDate = new Date(today);
            endDate.setMonth(endDate.getMonth() + 1); // ë‹¤ìŒë‹¬
            
            timeline.innerHTML = '';
            
            const currentDate = new Date(startDate);
            while (currentDate <= endDate) {
                const dayElement = document.createElement('div');
                dayElement.className = 'timeline-day';
                
                if (currentDate.getDate() === 1) {
                    dayElement.className += ' timeline-month';
                    dayElement.textContent = `${currentDate.getMonth() + 1}ì›”`;
                } else {
                    if (currentDate.toDateString() === today.toDateString()) {
                        dayElement.className += ' timeline-today';
                    }
                    dayElement.innerHTML = `
                        <div>${currentDate.getDate()}</div>
                        <div style="font-size: 0.6rem;">${['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '][currentDate.getDay()]}</div>
                    `;
                }
                
                timeline.appendChild(dayElement);
                currentDate.setDate(currentDate.getDate() + 1);
            }
        }

        function loadTeacherTasks() {
            if (!currentTeacher) return;
            
            const tasks = testData.tasks.filter(task => task.teacherId === currentTeacher.id);
            renderTasks(tasks);
        }

        function renderTasks(tasks) {
            // ëª¨ë“  ì»¬ëŸ¼ ì´ˆê¸°í™”
            const columns = [
                'mandatory-ongoing', 'low-hanging-ongoing', 'deep-infra-ongoing', 'innovation-ongoing',
                'mandatory-nice-to-have', 'low-hanging-nice-to-have', 'deep-infra-nice-to-have', 'innovation-nice-to-have',
                'done-column'
            ];
            
            columns.forEach(columnId => {
                const column = document.getElementById(columnId);
                if (column) column.innerHTML = '';
            });

            tasks.forEach(task => {
                const taskElement = createTaskElement(task);
                const columnId = task.status === 'done' ? 'done-column' : `${task.category}-${task.priorityGroup}`;
                const column = document.getElementById(columnId);
                if (column) {
                    column.appendChild(taskElement);
                }
            });
        }

        function createTaskElement(task) {
            const div = document.createElement('div');
            div.className = 'task-item';
            div.draggable = true;
            div.ondragstart = (e) => drag(e, task.id);
            
            const isOverdue = task.dueDate && new Date(task.dueDate) < new Date();
            if (isOverdue && task.status !== 'done') {
                div.style.borderColor = '#ef4444';
                div.style.backgroundColor = '#fef2f2';
            }

            div.innerHTML = `
                <div class="font-medium mb-2">${task.content}</div>
                ${task.estimatedTime ? `<div class="text-sm text-gray-600 mb-1">ì˜ˆìƒ: ${task.estimatedTime}ì‹œê°„</div>` : ''}
                ${task.actualTime ? `<div class="text-sm text-green-600 mb-1">ì‹¤ì œ: ${task.actualTime}ì‹œê°„</div>` : ''}
                ${task.dueDate ? `<div class="text-sm text-gray-600 mb-2">ë§ˆê°: ${task.dueDate} ${task.taskType === 'daily' ? '(ë§¤ì¼)' : ''}</div>` : ''}
                <div class="flex justify-between items-center">
                    <span class="text-xs px-2 py-1 rounded" style="background: #e2e8f0;">${task.status}</span>
                    <div>
                        ${task.status !== 'done' ? `<button class="btn btn-primary btn-small" onclick="completeTask('${task.id}')">ì™„ë£Œ</button>` : ''}
                        <button class="btn btn-danger btn-small" onclick="deleteTask('${task.id}')">ì‚­ì œ</button>
                    </div>
                </div>
            `;
            
            return div;
        }

        function saveNewTeacher() {
            const name = newTeacherName.value.trim();
            if (!name) {
                alert('ì„ ìƒë‹˜ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const teacherId = 'teacher' + Date.now();
            const newTeacher = { id: teacherId, name: name };
            
            testData.teachers.push(newTeacher);
            saveData();
            loadTeachers();
            hideModal(teacherModal);
            newTeacherName.value = '';
        }

        function deleteSelectedTeacher() {
            if (!currentTeacher) {
                alert('ì‚­ì œí•  ì„ ìƒë‹˜ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            if (confirm(`ì •ë§ ${currentTeacher.name}ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\ní•´ë‹¹ ì„ ìƒë‹˜ì˜ ëª¨ë“  ì—…ë¬´ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                // ì„ ìƒë‹˜ ì‚­ì œ
                testData.teachers = testData.teachers.filter(t => t.id !== currentTeacher.id);
                // í•´ë‹¹ ì„ ìƒë‹˜ì˜ ì—…ë¬´ ì‚­ì œ
                testData.tasks = testData.tasks.filter(task => task.teacherId !== currentTeacher.id);
                
                saveData();
                
                // UI ì´ˆê¸°í™”
                currentTeacher = null;
                teacherSelect.value = '';
                deleteTeacherBtn.style.display = 'none';
                welcomeMessage.textContent = 'íš¨ìœ¨ì ì¸ ì—…ë¬´ ê´€ë¦¬ë¡œ ë” ë‚˜ì€ êµìœ¡ì„ ë§Œë“¤ì–´ê°€ì„¸ìš”!';
                hideTeacherBoard();
                loadTeachers();
            }
        }

        function addNewTask() {
            if (!currentTeacher) {
                alert('ì„ ìƒë‹˜ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const content = taskContentInput.value.trim();
            if (!content) {
                alert('ì—…ë¬´ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const taskData = {
                id: 'task' + Date.now(),
                content: content,
                estimatedTime: estimatedTimeInput.value ? parseInt(estimatedTimeInput.value) : null,
                dueDate: dueDateInput.value || null,
                category: taskCategorySelect.value,
                priorityGroup: taskPrioritySelect.value,
                taskType: taskTypeSelect.value,
                status: 'todo',
                teacherId: currentTeacher.id,
                createdAt: new Date().toISOString()
            };

            testData.tasks.push(taskData);
            saveData();
            
            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            taskContentInput.value = '';
            estimatedTimeInput.value = '';
            dueDateInput.value = '';
            taskCategorySelect.value = 'mandatory';
            taskPrioritySelect.value = 'ongoing';
            taskTypeSelect.value = 'deadline';
            
            loadTeacherTasks();
        }

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­
        window.allowDrop = function(event) {
            event.preventDefault();
        }

        window.drag = function(event, taskId) {
            event.dataTransfer.setData("text", taskId);
            event.target.classList.add('dragging');
        }

        window.drop = function(event, category, priorityGroup) {
            event.preventDefault();
            const taskId = event.dataTransfer.getData("text");
            
            const task = testData.tasks.find(t => t.id === taskId);
            if (task) {
                if (category === 'done') {
                    // ì™„ë£Œë¡œ ì´ë™í•  ë•ŒëŠ” ì™„ë£Œ ëª¨ë‹¬ í‘œì‹œ
                    taskToComplete = taskId;
                    showModal(completionModal);
                    return;
                } else {
                    task.category = category;
                    task.priorityGroup = priorityGroup;
                    task.status = 'todo';
                }
                
                saveData();
                loadTeacherTasks();
            }
        }

        // ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function showModal(modal) {
            modal.style.display = 'flex';
        }

        function hideModal(modal) {
            modal.style.display = 'none';
        }

        // ì—…ë¬´ ì™„ë£Œ
        window.completeTask = function(taskId) {
            taskToComplete = taskId;
            showModal(completionModal);
        }

        function confirmTaskCompletion() {
            if (!taskToComplete) return;

            const actualTime = actualTimeInput.value ? parseInt(actualTimeInput.value) : null;
            const task = testData.tasks.find(t => t.id === taskToComplete);
            
            if (task) {
                task.status = 'done';
                task.actualTime = actualTime;
                task.completedAt = new Date().toISOString();
                task.category = 'done';
                task.priorityGroup = null;
                
                saveData();
                loadTeacherTasks();

                // ì¶•í•˜ ë©”ì‹œì§€ í‘œì‹œ (1/3 í™•ë¥ )
                if (Math.random() < 0.33) {
                    showCelebration();
                }
            }

            hideModal(completionModal);
            actualTimeInput.value = '';
            taskToComplete = null;
        }

        // ì—…ë¬´ ì‚­ì œ
        window.deleteTask = function(taskId) {
            taskToDelete = taskId;
            showModal(deleteModal);
        }

        function confirmTaskDeletion() {
            if (!taskToDelete) return;

            testData.tasks = testData.tasks.filter(t => t.id !== taskToDelete);
            saveData();
            loadTeacherTasks();
            
            hideModal(deleteModal);
            taskToDelete = null;
        }

        function showCelebration() {
            const messages = [
                "ğŸ‰ í›Œë¥­í•´ìš”! ë˜ í•˜ë‚˜ì˜ ì„±ê³¼ë¥¼ ì´ë¤„ëƒˆë„¤ìš”!",
                "âœ¨ ëŒ€ë‹¨í•©ë‹ˆë‹¤! ê¾¸ì¤€í•œ ë…¸ë ¥ì´ ë¹›ì„ ë°œí•˜ê³  ìˆì–´ìš”!",
                "ğŸš€ ì™„ë²½í•´ìš”! ì´ëŸ° í˜ì´ìŠ¤ë¼ë©´ ëª©í‘œ ë‹¬ì„±ì€ ì‹œê°„ë¬¸ì œë„¤ìš”!",
                "ğŸŒŸ ìµœê³ ì˜ˆìš”! í•™ìƒë“¤ì´ ë”ìš± ì¢‹ì€ êµìœ¡ì„ ë°›ì„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”!",
                "ğŸ’ª ë©‹ì ¸ìš”! ì˜¤ëŠ˜ë„ êµìœ¡ í˜ì‹ ì„ ìœ„í•œ í•œ ê±¸ìŒì„ ë‚´ë””ë ë„¤ìš”!"
            ];
            
            const randomMessage = messages[Math.floor(Math.random() * messages.length)];
            celebrationMessage.textContent = randomMessage;
            showModal(celebrationModal);
            
            setTimeout(() => {
                hideModal(celebrationModal);
            }, 3000);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒ˜í”Œ ë°ì´í„° ì¶”ê°€ (ì²˜ìŒ ì‹¤í–‰ ì‹œì—ë§Œ)
        if (testData.tasks.length === 0) {
            const sampleTasks = [
                {
                    id: 'sample1',
                    content: 'ìˆ˜í•™ ì‹œí—˜ ë¬¸ì œ ì¶œì œ',
                    estimatedTime: 2,
                    dueDate: '2025-05-30',
                    category: 'mandatory',
                    priorityGroup: 'ongoing',
                    taskType: 'deadline',
                    status: 'todo',
                    teacherId: 'teacher1',
                    createdAt: new Date().toISOString()
                },
                {
                    id: 'sample2',
                    content: 'í•™ë¶€ëª¨ ìƒë‹´ ì „í™”',
                    estimatedTime: 1,
                    dueDate: '2025-05-29',
                    category: 'low-hanging',
                    priorityGroup: 'ongoing',
                    taskType: 'daily',
                    status: 'todo',
                    teacherId: 'teacher1',
                    createdAt: new Date().toISOString()
                },
                {
                    id: 'sample3',
                    content: 'ì˜¨ë¼ì¸ ê°•ì˜ ì‹œìŠ¤í…œ êµ¬ì¶•',
                    estimatedTime: 8,
                    dueDate: '2025-06-15',
                    category: 'deep-infra',
                    priorityGroup: 'nice-to-have',
                    taskType: 'deadline',
                    status: 'todo',
                    teacherId: 'teacher2',
                    createdAt: new Date().toISOString()
                }
            ];
            
            testData.tasks = sampleTasks;
            saveData();
        }
    </script>
</body>
</html> 